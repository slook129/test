<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>The Flow | Correlation Recorder</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="Effortlessly handle dynamic values in JMeter with the Correlation recorder plugin.">
    <meta name="theme-color" content="#00ace6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/CorrelationRecorder/assets/css/0.styles.4810017e.css" as="style"><link rel="preload" href="/CorrelationRecorder/assets/js/app.bb4aa901.js" as="script"><link rel="preload" href="/CorrelationRecorder/assets/js/2.6ea06575.js" as="script"><link rel="preload" href="/CorrelationRecorder/assets/js/1.b6717865.js" as="script"><link rel="preload" href="/CorrelationRecorder/assets/js/38.dae33b16.js" as="script"><link rel="prefetch" href="/CorrelationRecorder/assets/js/11.8014cc93.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/12.67c49a6d.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/13.679812f5.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/14.8773e5b1.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/15.90aee2e5.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/16.2103d58a.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/17.4b820159.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/18.3f9ea548.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/19.3426ec3f.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/20.78e94103.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/21.18150f73.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/22.60cdd768.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/23.8b69fca4.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/24.c29fb8d5.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/25.59896ab5.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/26.9731c624.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/27.6cac7eed.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/28.100a92e3.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/29.52442ea7.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/3.024fff8e.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/30.e75de030.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/31.6a529cf2.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/32.6dc2a957.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/33.c88a296b.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/34.dd882226.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/35.f34343f0.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/36.74d4f9b1.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/37.e1551f81.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/39.29d68235.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/4.69d43775.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/40.1c71cc50.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/41.f609d504.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/42.8adaa236.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/43.e9af728d.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/44.03d8ef85.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/5.63afd147.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/6.7b6b1887.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/7.2b1c030a.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/8.85e2f905.js"><link rel="prefetch" href="/CorrelationRecorder/assets/js/vendors~docsearch.328e9ee2.js">
    <link rel="stylesheet" href="/CorrelationRecorder/assets/css/0.styles.4810017e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/CorrelationRecorder/" class="home-link router-link-active"><img src="/CorrelationRecorder/images/blazemeter-labs-logo.png" alt="Correlation Recorder" class="logo"> <span class="site-name can-hide">Correlation Recorder</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/CorrelationRecorder/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="/CorrelationRecorder/guide/templates/" class="nav-link">
  Templates
</a></div><div class="nav-item"><a href="/CorrelationRecorder/guide/custom-extensions/" class="nav-link router-link-active">
  Custom Extensions
</a></div><div class="nav-item"><a href="/CorrelationRecorder/contributing/" class="nav-link">
  Contributing
</a></div><div class="nav-item"><a href="/CorrelationRecorder/guide/troubleshooting.html" class="nav-link">
  FAQ
</a></div> <a href="https://github.com/Blazemeter/CorrelationRecorder" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/CorrelationRecorder/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="/CorrelationRecorder/guide/templates/" class="nav-link">
  Templates
</a></div><div class="nav-item"><a href="/CorrelationRecorder/guide/custom-extensions/" class="nav-link router-link-active">
  Custom Extensions
</a></div><div class="nav-item"><a href="/CorrelationRecorder/contributing/" class="nav-link">
  Contributing
</a></div><div class="nav-item"><a href="/CorrelationRecorder/guide/troubleshooting.html" class="nav-link">
  FAQ
</a></div> <a href="https://github.com/Blazemeter/CorrelationRecorder" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>The Flow</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/CorrelationRecorder/guide/custom-extensions/the_flow_explanation.html#the-steps" class="sidebar-link">The Steps</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/CorrelationRecorder/guide/custom-extensions/the_flow_explanation.html#the-explanation" class="sidebar-link">The Explanation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/CorrelationRecorder/guide/custom-extensions/the_flow_explanation.html#proxy" class="sidebar-link">Proxy</a></li><li class="sidebar-sub-header"><a href="/CorrelationRecorder/guide/custom-extensions/the_flow_explanation.html#engine" class="sidebar-link">Engine</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="the-flow"><a href="#the-flow" class="header-anchor">#</a> The Flow</h1> <p>In the following sections, we will cover topics regarding how JMeter process and sends the Requests and Responses to the plugin, when and where this will be affected by the configured Correlation Rules, and how the order of the methods affects the results the user will see during the recording.</p> <h2 id="the-steps"><a href="#the-steps" class="header-anchor">#</a> The Steps</h2> <p>In General Terms, the recording follows this order, for the case that involves processing with the plugin:</p> <ol><li>One Request goes to the server</li> <li>The server gives a Response</li> <li>JMeter takes both and sends them to the plugin</li> <li>The Proxy verifies and sends them to the CorrelationEngine (deliverSampler() method)</li> <li>The Engine applies all the Rules to the Response, Request and Recorded Sampler (process() method)</li> <li>The Proxy takes the processed values back to JMeter (super.deliverSampler() method)</li> <li>JMeter sends the Recorded Sampler to the configured Recording Controller</li></ol> <h2 id="the-explanation"><a href="#the-explanation" class="header-anchor">#</a> The Explanation</h2> <p>Now, on a detailed point of view, let's talk about each one of the steps of processing the recorded Samplers</p> <h3 id="proxy"><a href="#proxy" class="header-anchor">#</a> Proxy</h3> <h4 id="deliver-recorded-sampler"><a href="#deliver-recorded-sampler" class="header-anchor">#</a> Deliver Recorded Sampler</h4> <p>For the Correlation Recorder Plugin, the Proxy is handled by <code>CorrelationProxyControl.java</code>, who receives an HTTPSamplerBase (the recorded Sampler), and the SampleResult (the request and the response), process and sends it to the CorrelationEngine to be processed.</p> <p>All that occurs in the deliverSampler method.</p> <div class="language-java extra-class"><pre class="language-java"><code>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deliverSampler</span><span class="token punctuation">(</span><span class="token class-name">HTTPSamplerBase</span> sampler<span class="token punctuation">,</span> <span class="token class-name">TestElement</span><span class="token punctuation">[</span><span class="token punctuation">]</span> testElements<span class="token punctuation">,</span> <span class="token class-name">SampleResult</span> result<span class="token punctuation">)</span>
</code></pre></div><h4 id="context-reset"><a href="#context-reset" class="header-anchor">#</a> Context Reset</h4> <p>The <code>CorrelationProxyControl.java</code> also holds the responsibility of triggering the Contexts reset when a new recording starts, so each recorder flow starts from a clean base.</p> <h3 id="engine"><a href="#engine" class="header-anchor">#</a> Engine</h3> <p>The Engine contains, not only the configured Correlation Rules setup before starting the recording, but also each one of the Contexts (CorrelationContexts and any Custom Context) associated with then, in their updated form. This role is been handled by the <code>CorrelationEngine.java</code></p> <h4 id="responsibilities"><a href="#responsibilities" class="header-anchor">#</a> Responsibilities</h4> <p>At this point, the only responsibilities of the Engine are:</p> <ol><li>Apply all the configured CorrelationReplacements to the HTTPSamplerBase (the record)</li> <li>Update all the Contexts with the info that comes from the SampleResult (the result)</li> <li>Filter the Recorder HTTPSamplerBase by the <a href="https://github.com/Blazemeter/CorrelationRecorder/blob/master/README.md#filtering-your-requests" target="_blank" rel="noopener noreferrer">Response Filter<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>'s type</li> <li>Apply all the configured CorrelationExtractors to the HTTPSamplerBase (in case this one matches the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types" target="_blank" rel="noopener noreferrer">Filter MIME Type<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> from Step 3)</li></ol> <p>Anything that happens in the steps 1 and 4, will be handled by the <code>CorrelationRule</code> (applyReplacements for the former, and addExtractors for the later), for each configured Rule.</p> <h4 id="special-considerations"><a href="#special-considerations" class="header-anchor">#</a> Special Considerations</h4> <ol><li>Is important to mention that, because of the order of how the Correlation Components are applied and updated, the values that they extract or replace, only will be used after a future request. Because of this:</li></ol> <ul><li>Each value that is extracted from a Correlation Extractor, during the recording, will only be available for a Correlation Replacements in the next Request made</li> <li>All the updated context values only will be considered, in the actual Sampler, by the Correlation Extractor but, the Correlation Replacements will need to wait for the next Sampler to be able to see it. The execution of the Correlation’s Flow is, as mentioned before:</li></ul> <blockquote><p>Receives a Request → Receives a Response → Applies Correlation Replacements → Update Correlation Contexts → Applies Correlation Replacements</p></blockquote></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/CorrelationRecorder/assets/js/app.bb4aa901.js" defer></script><script src="/CorrelationRecorder/assets/js/2.6ea06575.js" defer></script><script src="/CorrelationRecorder/assets/js/1.b6717865.js" defer></script><script src="/CorrelationRecorder/assets/js/38.dae33b16.js" defer></script>
  </body>
</html>
